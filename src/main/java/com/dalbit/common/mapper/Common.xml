<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dalbit.common.dao.CommonDao" >
    <select id="callBroadCastRoomStreamIdRequest" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_broadcast_room_streamid_request(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callCodeDefineSelect" resultType="Map">
      	call sp_code_define_select
    </select>

    <insert id="requestSms" parameterType="SmsVo" useGeneratedKeys="true" keyProperty="CMID" keyColumn="CMID">
        <selectKey keyProperty="CMID" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
      	INSERT INTO hp_msg(
          UMID
          , MSG_TYPE
          , SEND_PHONE
          , DEST_PHONE
          , SUBJECT
          , MSG_BODY
        ) values(
          #{umId}
          , '0'
          , #{sendPhoneNo}
          , #{phoneNo}
          , 'TEST'
          , CONCAT('[달빛라디오] 인증번호는 (', #{code}, ') 입니다.')
        )
    </insert>

    <select id="callMemberCertification" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_certification(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="getCertificationChk" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_certification_check(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="saveErrorLog" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_log_error_data(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callPushAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_stmp_push_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

</mapper>