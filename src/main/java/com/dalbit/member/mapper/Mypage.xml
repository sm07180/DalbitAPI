<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dalbit.member.dao.MypageDao" >

    <select id="callProfileEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_profile_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callFanstarInsert" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_fanstar_insert(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callFanstarDelete" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_fanstar_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberInfo" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_info_view(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadBasic" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_basic_request(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadBasicEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_basic_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberReportAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_report_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberBlockAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_block_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberBlockDel" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_block_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberNotify" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_setting_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberNotifyEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_setting_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberShortCut" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MemberShortCutVo">
        call sp_member_broadcast_shortcut_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberShortCutEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_shortcut_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberGiftRuby" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_gift_ruby(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberNotification" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_NotificationVo">
        call sp_member_notification_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageNoticeAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageNoticeEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageNoticeDel" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageNoticeSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MypageNoticeSelectVo">
        call sp_member_broadcast_notice_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMyPageNoticeReplyAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_reply_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMyPageNoticeReplyDelete" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_reply_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMyPageNoticeReplyEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_notice_reply_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMyPageNoticeReplySelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_MypageNoticeReplyListVo">
        call sp_member_broadcast_notice_reply_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageMypageReportBroad" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MypageReportBroadVo">
        call sp_member_broadcast_broadcasting_report(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageMypageReportListen" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MypageReportListenVo">
        call sp_member_broadcast_listening_report(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMyapgeGetBanWord" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_banword_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageInsertBanWord" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_banword_save(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageSearchUser" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_SearchUserVo">
      call sp_member_broadcast_search(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageManager" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MypageManagerVo">
      call sp_member_broadcast_manager_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageManagerAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_manager_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageManagerEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_manager_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageManagerDel" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_manager_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageBlackListView" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_MypageBlackVo">
      call sp_member_broadcast_black_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageBlackListAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_black_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMypageBlackListDel" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_broadcast_black_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="changeItemSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="P_ChangeItemListVo">
      call sp_member_change_item_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="changeItem" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_change_item(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callAutoChangeSettingEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_auto_change_setting_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callAutoChangeSettingSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_auto_change_setting_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callReadNotification" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
      call sp_member_notification_read(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <update id="callReadALLNotification" parameterType="P_NotificationVo" >
        UPDATE tb_member_notification
			SET read_yn = 1
		WHERE mem_no = #{mem_no}
    </update>

    <select id="selectMyByeolCnt" parameterType="String" resultType="long">
        SELECT gold FROM tb_member_wallet WHERE mem_no = #{value}
    </select>

    <select id="selectExistsSpecialReq" parameterType="String" resultType="int">
        SELECT
          COUNT(*)
        FROM rd_admin.tb_req_special_dj
        WHERE mem_no = #{value}
          -- AND state = 1
          <!-- 스페셜 DJ는 매달 신청을 받는다. -->
          AND DATE_FORMAT(reg_date, '%Y%m') = DATE_FORMAT(now(), '%Y%m')
    </select>

    <select id="selectExistsPhoneSpecialReq" parameterType="String" resultType="int">
        SELECT
          COUNT(*)
        FROM rd_admin.tb_req_special_dj
        WHERE mem_phone = #{value}
          AND state = 1
          <!-- 스페셜 DJ는 매달 신청을 받는다. -->
          AND DATE_FORMAT(reg_date, '%Y%m') = DATE_FORMAT(now(), '%Y%m')
    </select>

    <insert id="insertSpecialReq" parameterType="P_SpecialDjReq">
        INSERT INTO rd_admin.tb_req_special_dj(
          mem_no
          , mem_name
          , mem_phone
          , title
          , contents
          , broadcast_time1
          , broadcast_time2
          , reg_date
          , state
        ) values (
          #{mem_no}
          , #{name}
          , #{phone}
          , #{title}
          , #{contents}
          , #{broadcast_time1}
          , #{broadcast_time2, jdbcType=VARCHAR}
          , NOW()
          , 1
        )
    </insert>

    <select id="selectLevel" resultType="LevelVo">
      SELECT
        `level`
        , grade
        , ruby AS dal
        , gold AS byeol
      FROM tbl_level_exp
      WHERE `level` > 0 ORDER BY `level` ASC
    </select>

    <select id="callNewAlarm" parameterType="com.dalbit.member.vo.procedure.P_MemberNotifyVo" resultType="int">
		SELECT COUNT(*) FROM tb_member_notification WHERE mem_no = #{mem_no} AND read_yn = '0'
    </select>

    <select id="selectSpecialDjBroadcastTime" parameterType="com.dalbit.member.vo.SpecialDjConditionSearchVo" resultType="long">
        /* Mypage.xml - selectSpecialDjBroadcastTime */
        select TRUNCATE(ifnull(sum(airtime), 0) / 3600, 0) airtime
        from rd_data.tb_broadcast_room
        where mem_no = #{mem_no}
            and DATE_FORMAT(concat(#{condition_start_date}, ' 00:00:00'), '%Y-%m-%d %H:%i:%s') <![CDATA[<=]]> start_date
            and start_date <![CDATA[<=]]> DATE_FORMAT(concat(#{condition_end_date}, ' 23:59:59'), '%Y-%m-%d %H:%i:%s')
    </select>

    <select id="selectSpecialDjLikeCnt" parameterType="com.dalbit.member.vo.SpecialDjConditionSearchVo" resultType="int">
        /* Mypage.xml - selectSpecialDjLikeCnt */
        select sum(cnt)
        from(
            select count(*) cnt
            from rd_data.tb_broadcast_room_good
            where dj_mem_no = #{mem_no}
                and DATE_FORMAT(concat(#{condition_start_date}, ' 00:00:00'), '%Y-%m-%d %H:%i:%s') <![CDATA[<=]]> last_upd_date
                and last_upd_date <![CDATA[<=]]> DATE_FORMAT(concat(#{condition_end_date}, ' 23:59:59'), '%Y-%m-%d %H:%i:%s')

            union all

            select count(*) * 10
            from rd_data.tb_member_broadcast_item item
            where item.gifted_mem_no = #{mem_no}
                and item_type = 2
                and DATE_FORMAT(concat(#{condition_start_date}, ' 00:00:00'), '%Y-%m-%d %H:%i:%s') <![CDATA[<=]]> item.last_upd_date
                and item.last_upd_date <![CDATA[<=]]> DATE_FORMAT(concat(#{condition_end_date}, ' 23:59:59'), '%Y-%m-%d %H:%i:%s')
        ) a
    </select>

    <select id="selectSpecialDjBroadcastCnt" parameterType="com.dalbit.member.vo.SpecialDjConditionSearchVo" resultType="int">
        /* Mypage.xml - selectSpecialDjBroadcastCnt */
        select count(*)
        from rd_data.tb_broadcast_room
        where mem_no = #{mem_no}
            and 5400 <![CDATA[<=]]> airtime
            and DATE_FORMAT(concat(#{condition_start_date}, ' 00:00:00'), '%Y-%m-%d %H:%i:%s') <![CDATA[<=]]> start_date
            and start_date <![CDATA[<=]]> DATE_FORMAT(concat(#{condition_end_date}, ' 23:59:59'), '%Y-%m-%d %H:%i:%s')
    </select>

    <select id="selectSpecialDjReqManage" parameterType="com.dalbit.member.vo.SpecialDjRegManageVo" resultType="com.dalbit.member.vo.SpecialDjRegManageVo">
        /* Mypage.xml - selectSpecialDjReqManage */
        select
            idx
            , title
            , select_year
            , select_month
            , date_format(req_start_date, '%Y%m%d000000') req_start_date
            , date_format(req_end_date, '%Y%m%d235959') req_end_date
            , date_format(condition_start_date, '%Y.%m.%d') condition_start_date
            , date_format(condition_end_date, '%Y.%m.%d') condition_end_date
            , condition_code1
            , condition_data1
            , condition_code2
            , condition_data2
            , condition_code3
            , condition_data3
            , is_view
            , platform
        from rd_admin.tb_req_special_dj_manage
        where select_year = #{select_year}
            and select_month = #{select_month}
    </select>

    <select id="selectSpecialDjReqContent" parameterType="com.dalbit.member.vo.SpecialDjRegManageVo" resultType="com.dalbit.member.vo.SpecialDjContentVo">
        /* Mypage.xml - selectSpecialDjReqContent */
        select
            content_type
            , image_pc_url
            , image_mobile_url
            , button_type
            , button_name
            , button_name_color
            , button_color
            , button_pc_link
            , button_mobile_link
        from rd_admin.tb_req_special_dj_content
        where select_year = #{select_year}
            and select_month = #{select_month}
        order by content_order asc
    </select>

    <select id="selectMemberLevel" parameterType="java.lang.String" resultType="com.dalbit.admin.vo.MemberInfoVo">
        /* Mypage.xml - selectMemberLevel */
        select
            mem_no
            , `level`
            , grade
            , exp
            , last_upd_date
        from rd_data.tb_member_level
        where mem_no = #{mem_no}
    </select>

    <select id="selectMemberFanCnt" parameterType="java.lang.String" resultType="int">
        /* Mypage.xml - selectMemberFanCnt */
        select count(*)
        from rd_data.tb_member_fanstar
        where mem_no_star = #{mem_no}
    </select>

    <select id="selectListenerCnt" parameterType="com.dalbit.member.vo.SpecialDjConditionSearchVo" resultType="int">
        /* Mypage.xml - selectMemberLevel */
        select ifnull(sum(listener), 0)
        from rd_data.tb_member_broadcast_broadcasting
        where mem_no = #{mem_no}
            and DATE_FORMAT(concat(#{condition_start_date}, ' 00:00:00'), '%Y-%m-%d %H:%i:%s') <![CDATA[<=]]> last_upd_date
            and last_upd_date <![CDATA[<=]]> DATE_FORMAT(concat(#{condition_end_date}, ' 23:59:59'), '%Y-%m-%d %H:%i:%s')
    </select>

    <select id="memberShortCutAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_shortcut_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>


    <select id="memberShortCutExtend" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_shortcut_extend(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="msgClickUpdate" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_broadcast_msg_click_update(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="selectAdminBadge" parameterType="String" resultType="int">
        SELECT
            *
        FROM (
            SELECT admin_badge FROM tb_member_profile WHERE mem_no = #{value}
            UNION ALL
            SELECT 0
        ) AS a
        ORDER BY admin_badge DESC
        LIMIT 1
    </select>

    <select id="callMemberEmoticon" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_EmoticonListVo">
        call sp_member_broadcast_emoticon_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberNotificationDelete" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_notification_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="selectEmoticonCategory" resultType="com.dalbit.member.vo.EmoticonCategoryListVo">
         SELECT
            idx as idx
            ,category_order as categoryOrderNo
            ,category_nm as categoryNm
        FROM rd_admin.tbl_emoticon_category
        ORDER BY category_order
    </select>

    <select id="selectMyPageNew" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
                    (SELECT COUNT(*) FROM tb_member_fanboard WHERE mem_no = #{myMemNo} AND STATUS &lt;&gt; 2 AND idx &gt; #{fanBoard} AND DATEDIFF(now(), last_upd_date ) &lt;= 7 and depth = 1 and view_yn = 1)
                ELSE
                    (SELECT COUNT(*) FROM tb_member_fanboard WHERE mem_no = #{targetMemNo} AND STATUS &lt;&gt; 2 AND DATEDIFF(now(), last_upd_date ) &lt;= 7 and depth = 1 and view_yn = 1)
            END) AS fanBoard,
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
                    0
                ELSE
                    (SELECT COUNT(*) FROM tb_member_broadcast_notice WHERE mem_no = #{targetMemNo} AND DATEDIFF(now(), last_upd_date ) &lt;= 7)
            END)AS broadNotice,
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
                    (SELECT COUNT(*) FROM tb_member_wallet_ruby WHERE mem_no = #{myMemNo} AND idx &gt; #{dal} AND `type` IN (5, 7, 10, 11, 12, 22, 23) AND ruby &gt; 0)
                ELSE 0
            END) AS dal,
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
                    (SELECT COUNT(*) FROM tb_member_wallet_gold WHERE mem_no = #{myMemNo} and idx &gt; #{byeol} AND `type` IN (2, 4, 6, 21, 22, 23) AND gold &gt; 0)
                ELSE 0
            END) AS byeol,
            <if test = 'notice == null or notice == ""'>
                (SELECT COUNT(*) FROM tb_service_center_notice WHERE view_on = 1 AND DATEDIFF(now(), last_upd_date ) &lt;= 7)
            </if>
            <if test = 'notice != null and notice != ""'>
                (SELECT COUNT(*) FROM tb_service_center_notice WHERE view_on = 1 AND DATEDIFF(now(), last_upd_date ) &lt;= 7 AND idx NOT IN (${notice}))
            </if>
            AS notice,
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
            <if test = 'qna == null or qna == ""'>
                    (SELECT COUNT(*) FROM tb_service_center_qna_v25 WHERE mem_no = #{myMemNo} AND state = 1 AND DATEDIFF(now(), op_date ) &lt;= 7)
            </if>
            <if test = 'qna != null and qna != ""'>
                    (SELECT COUNT(*) FROM tb_service_center_qna_v25 WHERE mem_no = #{myMemNo} AND state = 1 AND DATEDIFF(now(), op_date ) &lt;= 7 AND idx NOT IN (CONCAT('', ${qna})))
            </if>
                ELSE 0
            END) AS qna,
            (CASE
                WHEN #{myMemNo} = #{targetMemNo} THEN
                    (SELECT COUNT(*) FROM tb_member_notification WHERE mem_no = #{mem_no} AND read_yn = 0)
                ELSE
                    0
            END) AS alarm
    </select>

    <select id="selectMyPageFanBoard" parameterType="String" resultType="Long">
        SELECT MAX(idx) as fanBoard FROM tb_member_fanboard WHERE mem_no = ${value} AND STATUS &lt;&gt; 2
    </select>

    <select id="selectMyPageWallet" parameterType="String" resultType="java.util.HashMap">
        SELECT
            (SELECT MAX(idx) FROM tb_member_wallet_ruby WHERE mem_no = ${value} AND `type` IN (5, 7, 10, 11, 12, 22, 23) AND ruby &gt; 0) AS dal,
            (SELECT MAX(idx) FROM tb_member_wallet_gold WHERE mem_no = ${value} AND `type` IN (2, 4, 6, 21, 22, 23) AND gold &gt; 0) AS byeol
    </select>

    <select id="callBroadcastTitleAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_title_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastTitleEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_title_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastTitleSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_BroadcastOptionListVo">
        call sp_member_broadcast_title_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastTitleDelete" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_title_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastWelcomeMsgAdd" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_welcome_msg_add(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastWelcomeMsgEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_welcome_msg_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastWelcomeMsgSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_BroadcastOptionListVo">
        call sp_member_broadcast_welcome_msg_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastWelcomeMsgDelete" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_welcome_msg_delete(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberGoodList" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_GoodListVo">
        call sp_member_good_list(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastSettingSelect" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_setting_select(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callBroadcastSettingEdit" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_broadcast_setting_edit(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callMemberBoardCount" statementType="CALLABLE" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        call sp_member_board_count(#{target_mem_no, mode=IN, jdbcType=VARCHAR}, #{mem_no, mode=IN, jdbcType=VARCHAR})
    </select>

    <select id="callMemberBoardStory" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_StoryVo">
        call sp_member_broadcast_story(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callWalletPopupListView" statementType="CALLABLE" parameterType="ProcedureVo" resultType="ProcedureVo">
        call sp_member_wallet_dal_byeol(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="callWalletList" statementType="CALLABLE" parameterType="ProcedureVo" resultType="com.dalbit.member.vo.procedure.P_WalletListVo">
        call sp_member_wallet_dal_byeol_list(#{data, mode=IN, jdbcType=VARCHAR}, #{ret, mode=OUT, jdbcType=INTEGER}, #{ext, mode=OUT, jdbcType=VARCHAR})
    </select>

    <select id="selectIsSpecial" parameterType="String" resultType="Integer">
        SELECT specialdj_badge FROM tb_member_profile WHERE mem_no = #{value};
    </select>
</mapper>